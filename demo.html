<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Rectangular Demo</title>
    <style>

    </style>
    <script src="rectangular.js"></script>
    <script>
        'use strict';

        window.onload = function() {

            var body = document.querySelector('body'), vars = {};

            Array.prototype.slice.call(document.getElementsByTagName('input')).forEach(function(elt) {
                elt.onclick = stop;
            });

            Array.prototype.slice.call(document.getElementsByTagName('button')).forEach(function(button) {
                var varBox = button.getElementsByClassName('var');
                var parms = button.getElementsByClassName('parm');

                switch (button.className) {
                    case 'newrect':
                        button.onclick = function(/*evt*/) {
                            newDiv(
                                varBox[0],
                                new rectangular.Rectangle(
                                    parms[0].value,
                                    parms[1].value,
                                    parms[2].value,
                                    parms[3].value
                                )
                            )
                                .className = button.className;
                        };
                        break;
                    case 'intersect':
                        button.onclick = function(/*evt*/) {
                            newDiv(
                                varBox[0],
                                vars[varBox[1].value].intersect(vars[varBox[2].value])
                            )
                                .className = button.className;
                        };
                        break;
                }
            });

            function newDiv(varNameElt, rectangle) {
                var name = varNameElt.value;
                vars[name] = rectangle;
                do {
                    varNameElt.value = name.replace(/(\d+)$/, Number(name.match(/\d+$/)) + 1);
                } while (varNameElt.value in vars);
                var obj = document.createElement('div');
                obj.className = 'obj';
                obj.style.left = rectangle.origin.x + 'px';
                obj.style.top = rectangle.origin.y + 'px';
                obj.style.width = rectangle.extent.x + 'px';
                obj.style.height = rectangle.extent.y + 'px';
                obj.innerHTML = name;
                body.appendChild(obj);
                return obj;
            }

            function stop(evt) {
                evt.stopPropagation();
                evt.preventDefault();
            }
        };

    </script>
</head>

<body>

<button class="newrect">
    var <input class="var" value="myRect1"/> =
        new Rectangle(
        <span>x=</span><input class="parm" id="x" value="100"/>,
    <span>y=</span><input class="parm" id="y" value="200"/>,
    <span>width=</span><input class="parm" id="width" value="150"/>,
    <span>height=</span><input class="parm" id="height" value="100"/>
    );
</button>

<button class="newrect">
    var <input class="var" value="myRect2"/> =
        new Rectangle(
        <span>x=</span><input class="parm" value="150"/>,
    <span>y=</span><input class="parm" value="250"/>,
    <span>width=</span><input class="parm" value="150"/>,
    <span>height=</span><input class="parm" value="100"/>
    );
</button>

<button class="intersect">
    var
        <input class="var" value="myInter1"/> =
    <input class="var" value="myRect1"/>.intersects(
    <input class="var" value="myRect2"/>
    );
</button>

</body>

</html>
